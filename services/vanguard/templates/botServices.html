{{define "body"}}
<h3>Integration Services</h3>
<p>Discord integration for your corporation or alliance!</p>
<p>All executor corp directors will have access to alter the configuration. You may also add delegates.</p>
{{template "checkAuthentication" .}}
	<div class="table-responsive">
		<div class="toolbar servicesToolbar" id="servicesToolbar">
			<div class="dropdown">
					<button type="button" class="btn btn-default btn-sm dropdown-toggle" id="addChar" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
						Add New Service
						<span class="caret"></span>
					</button>
					<ul class="dropdown-menu" id="addCharMenu" aria-labelledby="addChar">
						<li>
							<a class="adddiscord btn btn-default" href="javascript:">Add Discord</a>
						</li> 
					</ul>
				</div>
			</div>
		</div>

		<table class="table" data-show-refresh="true" data-cache="false" data-toolbar=".servicesToolbar"
			data-url="/U/botServices" id="servicesTable">
			<thead>
				<tr>
					<th data-field="type">Server Type</th>
					<th data-field="name">Server Name</th>
					<th data-field="entityName" data-formatter="entityTypeFormatter">Owning Entity</th>
					<th data-align="center" data-events="actionEvents"
					data-field="action" data-formatter="ServerActionsFormatter">Delete</th>
				</tr>
			</thead>
		</table>
	</div>

	<script>		
		var	$addservice = $('#addservice').modal({show: false}),
			$servicesTable = $('#servicesTable').bootstrapTable({url: "/U/botServices"}, "changeLocale", "en_US"),
			datum,
			selectedID;
	
		$(function () {
			$.ajax({
				url: '/U/crestTokens',
				dataType:'JSON',
				success:function(data){
					$.each(data, function(key, val){
						$('#tokenCharacterID').append('<option id=' + val.tokenCharacterID + '>' + val.characterName + '</option>');
					})
				},
				error:function(){
					$select.html('<option id="-1">You must add characters first.</option>');
				}
			});
		});

		function ServerActionsFormatter(value, row) {
			return [
				'<a class="removeServices" href="javascript:" title="Delete Item"><i class="glyphicon glyphicon-remove-circle"><\/i><\/a>',
			].join('');
		}
		// update and delete events
		window.actionEvents = {
			'click .removeServices': function (e, value, row) {
				if (confirm('Are you sure you want to delete this server?')) {
					console.log(row);
					$.ajax({
						
						url: "/U/botServices?botServerID=" + row.botServerID,
						type: 'delete',
						success: function () {
							$servicesTable.bootstrapTable('refresh');
							showAlert('Delete item successful!', 'success');
						},
						error: function () {
							showAlert('Delete item error!', 'danger');
						}
					})
				}
			}
		};
	</script>
{{end}}